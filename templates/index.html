<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LeetCode Progress Tracker</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <script src="https://cdn.jsdelivr.net/npm/apexcharts@latest"></script>
</head>
<body>
    <div class="container">
        <h1>üìä LeetCode Progress Tracker</h1>
        
        <div class="stats">
            {% for stat in stats %}
            <div class="user-stat"{% if has_difficulty_data and stat.get('easy_progress') is not none %} data-tooltip="true"{% endif %}>
                <h3>{{ stat.username }}</h3>
                <p>–í—Å–µ–≥–æ —Ä–µ—à–µ–Ω–æ: <strong>{{ stat.total }}</strong></p>
                <p>–ü—Ä–æ–≥—Ä–µ—Å—Å: <strong>+{{ stat.progress }}</strong></p>
                {% if has_difficulty_data %}
                <div class="difficulty-stats">
                    <span class="easy">Easy: {{ stat.easy }}</span>
                    <span class="medium">Medium: {{ stat.medium }}</span>
                    <span class="hard">Hard: {{ stat.hard }}</span>
                </div>
                <div class="tooltip-content">
                    <div class="tooltip-header">–ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏:</div>
                    <div class="tooltip-item easy">Easy: +{{ stat.easy_progress }}</div>
                    <div class="tooltip-item medium">Medium: +{{ stat.medium_progress }}</div>
                    <div class="tooltip-item hard">Hard: +{{ stat.hard_progress }}</div>
                </div>
                {% endif %}
            </div>
            {% endfor %}
        </div>
        
        <button class="refresh-btn" onclick="updateData()" id="updateBtn">üîÑ –û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</button>
        
        <div class="loading" id="loading">
            <p>‚è≥ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö... –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ.</p>
        </div>
        
        <div id="message"></div>
        
        <div class="chart-tabs">
            <button class="tab-btn active" data-chart="progress">üìà –ü—Ä–æ–≥—Ä–µ—Å—Å</button>
            <button class="tab-btn" data-chart="total">üìä –í—Å–µ–≥–æ –∑–∞–¥–∞—á</button>
            <button class="tab-btn" data-chart="daily">üìÖ –ü–æ –¥–Ω—è–º</button>
            {% if has_difficulty_data %}
            <button class="tab-btn" data-chart="difficulty-breakdown">üéØ –ü–æ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏</button>
            <button class="tab-btn" data-chart="difficulty-total">üìã –í—Å–µ–≥–æ –ø–æ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏</button>
            <button class="tab-btn" data-chart="difficulty-progress">‚ô®Ô∏è –ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏</button>
            <button class="tab-btn" data-chart="heatmap">üî• –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</button>
            {% endif %}
        </div>
        
        <div class="charts">
            <div class="chart active" id="progress-chart">
                <h2>–ü—Ä–æ–≥—Ä–µ—Å—Å (—Å –Ω–∞—á–∞–ª–∞ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è)</h2>
                <div id="progressChart" class="plot-container"></div>
            </div>
            
            <div class="chart" id="total-chart">
                <h2>–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ—à–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á</h2>
                <div id="totalChart" class="plot-container"></div>
            </div>
            
            <div class="chart" id="daily-chart">
                <h2>–ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ –¥–Ω—è–º</h2>
                <div id="dailyChart" class="plot-container"></div>
            </div>
            
            {% if has_difficulty_data %}
            <div class="chart" id="difficulty-breakdown-chart">
                <h2>–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —É—Ä–æ–≤–Ω—è–º —Å–ª–æ–∂–Ω–æ—Å—Ç–∏</h2>
                <div id="difficultyBreakdownChart" class="plot-container"></div>
            </div>
            
            <div class="chart" id="difficulty-total-chart">
                <h2>–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–¥–∞—á –ø–æ —É—Ä–æ–≤–Ω—è–º —Å–ª–æ–∂–Ω–æ—Å—Ç–∏</h2>
                <div class="difficulty-controls">
                    <button class="difficulty-btn active" data-difficulty="easy" onclick="toggleDifficultyLevel('difficulty-total', 'easy')">
                        <span class="difficulty-marker easy"></span>Easy
                    </button>
                    <button class="difficulty-btn active" data-difficulty="medium" onclick="toggleDifficultyLevel('difficulty-total', 'medium')">
                        <span class="difficulty-marker medium"></span>Medium
                    </button>
                    <button class="difficulty-btn active" data-difficulty="hard" onclick="toggleDifficultyLevel('difficulty-total', 'hard')">
                        <span class="difficulty-marker hard"></span>Hard
                    </button>
                </div>
                <div id="difficultyTotalChart" class="plot-container"></div>
            </div>
            
            <div class="chart" id="difficulty-progress-chart">
                <h2>–ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ —É—Ä–æ–≤–Ω—è–º —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ (—Å –Ω–∞—á–∞–ª–∞ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è)</h2>
                <div class="difficulty-controls">
                    <button class="difficulty-btn active" data-difficulty="easy" onclick="toggleDifficultyLevel('difficulty-progress', 'easy')">
                        <span class="difficulty-marker easy"></span>Easy
                    </button>
                    <button class="difficulty-btn active" data-difficulty="medium" onclick="toggleDifficultyLevel('difficulty-progress', 'medium')">
                        <span class="difficulty-marker medium"></span>Medium
                    </button>
                    <button class="difficulty-btn active" data-difficulty="hard" onclick="toggleDifficultyLevel('difficulty-progress', 'hard')">
                        <span class="difficulty-marker hard"></span>Hard
                    </button>
                </div>
                <div id="difficultyProgressChart" class="plot-container"></div>
            </div>
            
            <div class="chart" id="heatmap-chart">
                <h2>–¢–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</h2>
                <div id="heatmapChart" class="plot-container"></div>
            </div>
            {% endif %}
        </div>
        
        <div class="last-update">
            –ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: {{ last_update }}
        </div>
    </div>
    
    <script src="/static/js/app.js"></script>
    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –Ω–∞–ª–∏—á–∏–∏ –¥–∞–Ω–Ω—ã—Ö –ø–æ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
        window.hasDifficultyData = {{ 'true' if has_difficulty_data else 'false' }};
    </script>
</body>
</html>
